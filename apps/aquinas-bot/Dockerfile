FROM node:20-alpine

ARG APP_VERSION
ARG DISCORD_TOKEN
ARG DISCORD_CLIENT_ID
ARG ASSETS_DIR
ARG DB_CONFIG_FILE

WORKDIR /bot
COPY ./dist/apps/aquinas-bot .
COPY ./config ./config
COPY ./db ./db

ENV APP_VERSION=${APP_VERSION}
ENV DISCORD_TOKEN=${DISCORD_TOKEN}
ENV DISCORD_CLIENT_ID=${DISCORD_CLIENT_ID}
ENV ASSETS_DIR=${ASSETS_DIR}
ENV DB_CONFIG_FILE=${DB_CONFIG_FILE}

ENV PORT=3333
EXPOSE ${PORT}

RUN npm install

CMD node main.js